<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.12.0 by Michael Rose
  Copyright 2013-2018 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Journey Through Spring</title>
<meta name="description" content="A pragmatic approach to learning the Spring Framework.">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Journey Through Spring">
<meta property="og:title" content="Journey Through Spring">
<meta property="og:url" content="http://localhost:4000/_pages/spring-core/validation/">












  

  


<link rel="canonical" href="http://localhost:4000/_pages/spring-core/validation/">







  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "Steven Zgaljic",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Journey Through Spring Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="/">Journey Through Spring</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/core/welcome-core" >Core</a>
            </li>
          
        </ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle Menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Introduction</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/core/what-is-spring" class="">What is Spring?</a></li>
          
            
            

            
            

            <li><a href="/core/spring-kotlin" class="">Spring and Kotlin</a></li>
          
            
            

            
            

            <li><a href="/core/spring-references" class="">References</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Getting Started</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/core/spring-magic" class="">Understaing the "Magic" of Spring</a></li>
          
            
            

            
            

            <li><a href="/core/spring-starters" class="">Spring Boot Starters</a></li>
          
            
            

            
            

            <li><a href="/core/spring-debugging" class="">Debugging a Spring Application</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>
    
  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> Contents</h4></header>
              <ul class="toc__menu">
  <li><a href="#the-trasherror-bag-pattern">The Trash/Error Bag Pattern</a></li>
  <li><a href="#the-validator-interface">The Validator Interface</a></li>
  <li><a href="#running-the-validator">Running the Validator</a></li>
  <li><a href="#validation-with-annotations-jsr-303">Validation with Annotations (JSR-303)</a>
    <ul>
      <li><a href="#custom-jsr-303-annotation-validator">Custom JSR-303 Annotation Validator</a></li>
    </ul>
  </li>
  <li><a href="#errorcode-messagesource-and-resourcebundle">ErrorCode, MessageSource and ResourceBundle</a>
    <ul>
      <li><a href="#hibernate-validationproperties">Hibernate Validation.properties</a></li>
      <li><a href="#messagesproperties-convention">messages.properties convention</a></li>
    </ul>
  </li>
  <li><a href="#api-error-framework">API Error Framework</a></li>
</ul>
            </nav>
          </aside>
        
        <table><tr><td><a href="https://github.com/JahnelGroup/journey-through-spring">Table of Contents</a></td></tr></table>

<h1 id="validation">Validation</h1>
<p>Before using a piece of a data you typically want to <a href="https://en.wikipedia.org/wiki/Data_validation">validate</a> it first. Validation takes many forms and really depends on where the data is coming from and where the validation check is being done. If you’re passing data from one class to another via a function call then maybe some light validations are warranted (i.e., null checks) but if you’re receiving data from an external source you typically need to scrutinize it further.</p>

<p>Spring provides a light specification around validating Beans with a lot of the implementation provided by Hibernate.</p>

<ul>
  <li><strong>Read:</strong> <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#validation"><strong>spring.io:</strong> Validation</a></li>
  <li><strong>Read:</strong> <a href="http://hibernate.org/validator/"><strong>hibernate.org:</strong> Hibernate Validators</a></li>
  <li><strong>Read:</strong> <a href="https://www.tutorialspoint.com/springmvc/springmvc_hibernate_validator.htm"><strong>tutorialspoint.com:</strong> Spring MVC - Hibernate Validator Example</a></li>
  <li><strong>Read:</strong> <a href="https://www.mkyong.com/spring-mvc/combine-spring-validator-and-hibernate-validator/"><strong>mkyong.com:</strong> Combine Spring validator and Hibernate validator</a></li>
  <li><strong>Exercise:</strong> <a href="https://github.com/JahnelGroup/journey-through-spring/tree/master/basic-web-validations"><strong>github.com:</strong> Journey Through Spring: Basic Web Validations</a></li>
</ul>

<h2 id="the-trasherror-bag-pattern">The Trash/Error Bag Pattern</h2>
<p>Although not an official <em>design pattern</em> Spring’s validation framework follows a technique called an <strong>error bag</strong>. The idea is named well because you basically create a “trash bag” object that you pass around to interested parties that will put their “trash” or errors into the bag. Afterwards you inspect the trash bag for errors and handle them accordingly.</p>

<ul>
  <li>The trash bag is an instance of <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/validation/Errors.html">Errors</a>.</li>
  <li>The interested parties your implementations of <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/validation/Validator.html">Validators</a>.</li>
</ul>

<h2 id="the-validator-interface">The Validator Interface</h2>
<p>The whole point of the Validator interface is to validate an object. Here is an example of a simple Person POJO.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>

<span class="nd">@Data</span>
<span class="nd">@NoArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">firstName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">lastName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">gender</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <p>I used a library here called <a href="https://projectlombok.org/">Lombok</a> that helps generate boiler plate code like getters, setters, hashcode, equals and toString.</p>
</blockquote>

<p>We can create a Validator to validate a Person given whatever business requirements we have. For the purpose of brevity I’m only going to show one validation here. You can view the entire <a href="https://github.com/JahnelGroup/journey-through-spring/blob/master/basic-web-validations/src/main/java/com/example/basicwebvalidations/with_interface/PersonValidator.java">PersonValidator.java</a> in the Journey Through Spring exercise.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PersonValidator</span> <span class="kd">implements</span> <span class="n">Validator</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">supports</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">clazz</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">Person</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">clazz</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">validate</span><span class="o">(</span><span class="n">Object</span> <span class="n">target</span><span class="o">,</span> <span class="n">Errors</span> <span class="n">errors</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Person</span> <span class="n">person</span> <span class="o">=</span> <span class="o">(</span><span class="n">Person</span><span class="o">)</span> <span class="n">target</span><span class="o">;</span>

        <span class="k">if</span><span class="o">(</span><span class="n">person</span><span class="o">.</span><span class="na">getAge</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">person</span><span class="o">.</span><span class="na">getAge</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">21</span><span class="o">){</span>
           <span class="n">errors</span><span class="o">.</span><span class="na">rejectValue</span><span class="o">(</span>
              <span class="c1">// the first parameter is the name of the field we are validating, reflection </span>
              <span class="c1">// will be used to get it's value.</span>
              <span class="s">"age"</span><span class="o">,</span> 
              
              <span class="c1">// the second parameter is an arbitrary errorcode that I came up with to </span>
              <span class="c1">// represent a failure in this validation. </span>
              <span class="s">"underage"</span><span class="o">,</span> 
              
              <span class="c1">// the third parameter is the default human-readble text that represents this</span>
              <span class="c1">// type of failure when the errorcode lookup cannot be resolved.</span>
              <span class="s">"You are not old enough."</span>
           <span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <p>Error codes are discussed below and they are typically used to lookup the human-readable message text from a <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/MessageSource.html">MessageSource</a>.</p>
</blockquote>

<h2 id="running-the-validator">Running the Validator</h2>

<p>To run the validator you need an implemention of <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/validation/Errors.html">Errors</a>. There are a few implementations and we’ll use <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/validation/BeanPropertyBindingResult.html">BeanPropertyBindingResult</a> because thats what Spring MVC would normally provide you.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Errors</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BeanPropertyBindingResult</span><span class="o">(</span><span class="n">person</span><span class="o">,</span> <span class="s">"person"</span><span class="o">);</span>
<span class="n">personValidator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">person</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
<span class="k">if</span><span class="o">(</span> <span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">()</span> <span class="o">){</span>
    <span class="n">result</span><span class="o">.</span><span class="na">getAllErrors</span><span class="o">().</span><span class="na">stream</span><span class="o">().</span><span class="na">forEach</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>After running a Validator the Errors bag can be inspected for results. You can even pass the Errors bag to multiple validators.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Errors</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BeanPropertyBindingResult</span><span class="o">(</span><span class="n">person</span><span class="o">,</span> <span class="s">"person"</span><span class="o">);</span>
<span class="n">personNameValidator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">person</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
<span class="n">personAgeValidator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">person</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
<span class="c1">// etc</span>

<span class="c1">// now you have a collection of errors from all the validators</span>
<span class="k">if</span><span class="o">(</span> <span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">()</span> <span class="o">){</span>
    <span class="n">result</span><span class="o">.</span><span class="na">getAllErrors</span><span class="o">().</span><span class="na">stream</span><span class="o">().</span><span class="na">forEach</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Think about separating validators as it may or may not be a good idea depending on what you’re trying to accomplish.</p>

<h2 id="validation-with-annotations-jsr-303">Validation with Annotations (JSR-303)</h2>

<p>It is also possible to define validations as annotations directly on the properties of a Bean. This can be convenient for simple validations like null checks, lengths, or even more complicated custom validations.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.*</span><span class="o">;</span>

<span class="nd">@Data</span>
<span class="nd">@NoArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Pet</span> <span class="o">{</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">2</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">25</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">type</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Max</span><span class="o">(</span><span class="mi">30</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">weight</span><span class="o">;</span>

<span class="o">}</span>
</code></pre></div></div>

<p>Now you just need to apply the <a href="https://docs.oracle.com/javaee/7/api/javax/validation/Valid.html">@Valid</a> annotation on your payload in a Spring Controller to have Spring run the JSR-303 annotation validations.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/pets"</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">Pet</span> <span class="nf">addPet</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nd">@Valid</span> <span class="n">Pet</span> <span class="n">pet</span><span class="o">){</span>
    <span class="c1">// code</span>
<span class="o">}</span>
</code></pre></div></div>

<p>We haven’t defined anyway to inspect the Errors so Spring will return a payload that looks like this by default if a validation fails.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bad Request"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"arguments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"arguments"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"type"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"codes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                        </span><span class="s2">"pet.type"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="s2">"defaultMessage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"type"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"bindingFailure"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NotNull"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"codes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"NotNull.pet.type"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"NotNull.type"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"NotNull.java.lang.String"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"NotNull"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"defaultMessage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"must not be null"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"type"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"objectName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pet"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"rejectedValue"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>If you want to do something with the Errors then have Spring inject a <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/validation/BindingResult.html">BindingResult</a> object for you (it extends Errors). Spring will handle the binding in the same way you did it before manually.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/pets"</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">Pet</span> <span class="nf">addPet</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nd">@Valid</span> <span class="n">Pet</span> <span class="n">pet</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">){</span>
    <span class="k">if</span><span class="o">(</span> <span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">()</span> <span class="o">){</span>
        <span class="n">result</span><span class="o">.</span><span class="na">getAllErrors</span><span class="o">().</span><span class="na">stream</span><span class="o">().</span><span class="na">forEach</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">// code</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li><strong>Read:</strong> <a href="https://jcp.org/en/jsr/detail?id=303"><strong>jcp.org:</strong> JSR 303: Bean Validation</a></li>
  <li><strong>Read:</strong> <a href="https://en.wikipedia.org/wiki/Bean_Validation"><strong>wikipedia.org:</strong> Bean Validation</a></li>
  <li><strong>Read:</strong> <a href="https://developer.ucsd.edu/develop/data-layer/jpa/java-validation-api.html"><strong>developer.ucsd.edu:</strong> Java Validation API (JSR-303)</a></li>
</ul>

<h3 id="custom-jsr-303-annotation-validator">Custom JSR-303 Annotation Validator</h3>

<p>To make a custom JSR-303 validation you need two things - an annotation and a corresponding <a href="https://docs.oracle.com/javaee/7/api/javax/validation/ConstraintValidator.html">ConstraintValidator</a>.</p>

<p>Here is an example of a custom annotation called <strong>@PetId</strong> that we’ll use to validate that a Pet ID takes the format of 5 digits followed by a dash then two letters (i.e., 12345-AZ).</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Target</span><span class="o">({</span><span class="n">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">,</span> <span class="n">ElementType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="n">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Constraint</span><span class="o">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="n">PetIdNumberValidator</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">PetId</span> <span class="o">{</span>
    <span class="n">String</span> <span class="nf">message</span><span class="o">()</span> <span class="k">default</span> <span class="s">"{com.example.PetId.message}"</span><span class="o">;</span>
    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>
    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Here is the corresponding <a href="https://docs.oracle.com/javaee/7/api/javax/validation/ConstraintValidator.html">ConstraintValidator</a>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">javax.validation.ConstraintValidator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ConstraintValidatorContext</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PetIdNumberValidator</span> <span class="kd">implements</span>
        <span class="n">ConstraintValidator</span><span class="o">&lt;</span><span class="n">PetId</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="n">PetId</span> <span class="n">petId</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">,</span> <span class="n">ConstraintValidatorContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">value</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">value</span><span class="o">.</span><span class="na">matches</span><span class="o">(</span><span class="s">"[0-9]{5}-[A-Z]{2}"</span><span class="o">)</span>
                <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">14</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <p><strong>Important</strong>: Spring will initialize ConstraintValidator’s as a <strong>Singletons</strong> so only one instance will ever be created for each type. <strong>Do not</strong> store state anywhere here.</p>
</blockquote>

<ul>
  <li><strong>Read:</strong> <a href="http://www.baeldung.com/spring-mvc-custom-validator"><strong>baeldung.com:</strong> Spring MVC Custom Validation</a></li>
  <li><strong>Read:</strong> <a href="http://dolszewski.com/spring/custom-validation-annotation-in-spring/"><strong>dolszewski.com:</strong> Custom validation annotation in Spring</a></li>
</ul>

<h2 id="errorcode-messagesource-and-resourcebundle">ErrorCode, MessageSource and ResourceBundle</h2>
<p>Externalization of error messages is just as important as application properties. The process by which you do this is slightly different, instead of <em>properties</em> you have <em>messages</em> and instead of calling them <em>property files</em> they are <em>resource bundles</em>. This is an important step to making your system maintainable and support localization. To accomplish this you need a file somewhere in your classpath that is formatted as a key/value pair and loaded into the system as a ResourceBundle.</p>

<p>The entire process of mapping codes to message text is called message interpolation.</p>

<ul>
  <li><strong>Read:</strong> <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#context-functionality-messagesource"><strong>spring.io:</strong> Internationalization using MessageSource</a></li>
  <li><strong>Read:</strong> <a href="http://www.baeldung.com/spring-boot-internationalization"><strong>baeldung.com:</strong> Spring Boot Internationalization</a></li>
  <li><strong>Read:</strong> <a href="https://en.wikipedia.org/wiki/Java_resource_bundle"><strong>wikipedia.org:</strong> Java Resource Bundle</a></li>
  <li><strong>Read:</strong> <a href="https://docs.oracle.com/javase/7/docs/api/java/util/ResourceBundle.html"><strong>oracle.com:</strong> ResourceBundle</a></li>
  <li><strong>Read:</strong> <a href="https://docs.oracle.com/javase/tutorial/i18n/resbundle/concept.html"><strong>oracle.com:</strong> ResourceBundle Concept</a></li>
  <li><strong>Read:</strong> <a href="http://docs.jboss.org/hibernate/validator/5.4/reference/en-US/html_single/#chapter-message-interpolation"><strong>jboss.org:</strong> Message Interpolation</a></li>
</ul>

<h3 id="hibernate-validationproperties">Hibernate Validation.properties</h3>
<p>Hibernate validations will by default source their <em>defaultMessage</em> from a file on the classpath provided by Hibernate Validator called <strong>Validation.properties</strong>.</p>

<h3 id="messagesproperties-convention">messages.properties convention</h3>

<p>There are several ways to load a bundle and Spring provides a very convenient property called <em>spring.messages.basename</em> where you can set the location of the files. Spring Boot is smart enough to assume convention of course so by default it will look for <strong>messages.properties</strong> and load that as a resource bundle for you. Here is an example of a simple resource bundle:</p>

<blockquote>
  <p>Bundles support Locale change with the format messages_XX.properties, where XX is the locale code.</p>
</blockquote>

<p><strong>src/main/resources/messages.properties</strong></p>
<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Override default Spring Validation Field Error Messages
</span><span class="py">field.required</span><span class="p">=</span><span class="s">Required field</span>
<span class="py">field.max_length</span><span class="p">=</span><span class="s">Field cannot be greater than {0} characters</span>
<span class="py">field.min_length</span><span class="p">=</span><span class="s">Field cannot be less than {0} characters</span>

<span class="py">underage</span><span class="p">=</span><span class="s">You are only {0}, you must be at least 21!</span>
</code></pre></div></div>

<p><strong>This is currently broken in Spring.</strong></p>

<h2 id="api-error-framework">API Error Framework</h2>
<p>If you’re building a more sophisticated API then you would want more control over how the error responses are generated. This means mapping every type of exception into your own <em>ApiError</em> facade.</p>

<ul>
  <li><strong>Read:</strong> <a href="http://www.baeldung.com/global-error-handler-in-a-spring-rest-api"><strong>baeldung.com:</strong> Global Error Handler in Spring REST API</a></li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


        
      </footer>

      

      
    </div>

    
  </article>

  
  
</div>
    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
    
    
    
    
    
    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Steven Zgaljic. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.1.0/js/all.js"></script>








  </body>
</html>