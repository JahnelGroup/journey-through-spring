<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.12.0 by Michael Rose
  Copyright 2013-2018 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Journey Through Spring</title>
<meta name="description" content="A pragmatic approach to learning the Spring Framework.">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Journey Through Spring">
<meta property="og:title" content="Journey Through Spring">
<meta property="og:url" content="http://localhost:4000/_pages/spring-core/events/">












  

  


<link rel="canonical" href="http://localhost:4000/_pages/spring-core/events/">







  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "Steven Zgaljic",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Journey Through Spring Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--archive">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="/">Journey Through Spring</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/core/welcome-core" >Core</a>
            </li>
          
        </ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle Menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Introduction</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/core/what-is-spring" class="">What is Spring?</a></li>
          
            
            

            
            

            <li><a href="/core/spring-kotlin" class="">Spring and Kotlin</a></li>
          
            
            

            
            

            <li><a href="/core/spring-references" class="">References</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Getting Started</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/core/spring-magic" class="">Understaing the "Magic" of Spring</a></li>
          
            
            

            
            

            <li><a href="/core/spring-starters" class="">Spring Boot Starters</a></li>
          
            
            

            
            

            <li><a href="/core/spring-debugging" class="">Debugging a Spring Application</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>
    
  
  </div>


  <div class="archive">
    
      <h1 id="page-title" class="page__title"></h1>
    
    <table><tr><td><a href="https://github.com/JahnelGroup/journey-through-spring">Table of Contents</a></td></tr></table>

<h1 id="events">Events</h1>
<p>The concept of <a href="https://en.wikipedia.org/wiki/Event_(computing)">Events</a> is fundamental to computer programming and allows us to design components with loose coupling and high cohesion. Spring’s context is highly event driven and exposes this feature for you to listen and react to events as well as fire your own.</p>

<ul>
  <li><strong>Read:</strong> <a href="https://en.wikipedia.org/wiki/Event-driven_programming"><strong>wikipedia.org:</strong> Event-driven programming</a></li>
  <li><strong>Read:</strong> <a href="https://stackoverflow.com/questions/14000762/what-does-low-in-coupling-and-high-in-cohesion-mean"><strong>stackoverflow.com:</strong> What does ‘low in coupling and high in cohesion’ mean</a></li>
  <li><strong>Read:</strong> <a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-application-events-and-listeners"><strong>spring.io:</strong> Application Events and Listeners</a></li>
  <li><strong>Read:</strong> <a href="http://www.baeldung.com/spring-events"><strong>baeldung.com:</strong> Spring Events</a></li>
  <li><strong>Read:</strong> <a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#context-functionality-events"><strong>spring.io:</strong> Standard and Custom Events</a></li>
</ul>

<h2 id="applicationevent">ApplicationEvent</h2>
<p>Spring provides a class called <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/context/ApplicationEvent.html">ApplicationEvent</a> to faciliate the processing of events. Your events do not need to extend this class but it is good practice. Its constructor takes a single argument of type Object which is intended to be the <em>source</em> of the event.</p>

<h3 id="what-are-good-events">What are good Events?</h3>
<p>An event <em>source</em> is the Object for which the event is trigger against. For example, say you want to send an E-Mail to every user that signs up for your system. The event would be something like <em>UserSignedUpEvent</em> and the source would be the <em>User</em> object.</p>

<p>Events are things that <em>have happened</em> and they are past tense. UserLoggedInEvent states that a user has already logged in and you’re being notified of the fact. Do not use events in place of direct method invocation, that’s not the idea. They are more about a change to the conceptual design of your application and building a set of components that react to each other in a choreographed way.</p>

<p><strong>Read:</strong> <a href="https://stackoverflow.com/questions/4127241/orchestration-vs-choreography"><strong>stackoverflow.com:</strong> Orchestration vs. Choreography</a>
<strong>Read:</strong> <a href="https://www.thoughtworks.com/insights/blog/scaling-microservices-event-stream"><strong>thoughtworks.com:</strong> Scaling Microservices with an Event Stream</a></p>

<h3 id="events-are-pojos">Events are POJO’s</h3>
<p>With the except of extending ApplicationEvent for best practice, the event class it self should just be a plain old java object, nothing fancy, just a wrapper of data.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Model of a simple User 
</span><span class="kd">data class</span> <span class="nc">User</span><span class="p">(</span>
        <span class="kd">var</span> <span class="py">id</span><span class="p">:</span> <span class="n">Long</span> <span class="p">=</span> <span class="m">0L</span><span class="p">,</span>
        <span class="kd">var</span> <span class="py">username</span><span class="p">:</span> <span class="n">String</span> <span class="p">=</span> <span class="s">""</span><span class="p">,</span>
        <span class="kd">var</span> <span class="py">email</span><span class="p">:</span> <span class="n">String</span> <span class="p">=</span> <span class="s">""</span>
<span class="p">)</span>

<span class="c1">// Event to be raised when a new user signs up
</span><span class="kd">class</span> <span class="nc">UserSignedUpEvent</span><span class="p">(</span><span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="p">:</span> <span class="n">ApplicationEvent</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="raising-events-with-applicationeventpublisher">Raising Events with ApplicationEventPublisher</h2>
<p>Spring provides a convenient means to raise events with <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/context/ApplicationEventPublisher.html">ApplicationEventPublisher</a>. Inject this into any location where you need to raise events and call publish!</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">@Component</span>
<span class="kd">class</span> <span class="nc">UserService</span><span class="p">(</span>
        <span class="kd">var</span> <span class="py">userRepo</span><span class="p">:</span> <span class="n">UserRepository</span><span class="p">,</span>
        <span class="kd">var</span> <span class="py">appEventPublisher</span><span class="p">:</span> <span class="n">ApplicationEventPublisher</span><span class="p">){</span>

    <span class="cm">/**
      * Creates and saves a new user to the database, after succeeding it will
      * raise the UserSignedUpEvent for other interested components to react. 
      */</span> 
    <span class="k">fun</span> <span class="nf">register</span><span class="p">(</span><span class="n">username</span><span class="p">:</span><span class="n">String</span><span class="p">,</span> <span class="n">email</span><span class="p">:</span><span class="n">String</span><span class="p">){</span>
        <span class="kd">var</span> <span class="py">user</span> <span class="p">=</span> <span class="n">userRepo</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">User</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">email</span><span class="p">))</span>
        <span class="n">applicationEventPublisher</span><span class="p">.</span><span class="n">publishEvent</span><span class="p">(</span><span class="n">UserSignedUpEvent</span><span class="p">(</span><span class="n">user</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="listening-for-events">Listening for Events</h2>
<p>You can listen for events by either implementing the <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/ApplicationListener.html">ApplicationListener</a> interface or by the <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/event/EventListener.html">@EventListener</a> annotation. As always don’t forget that you class must be a Bean or else Spring will not have any control over it (here we are defining @Service).</p>

<p>Either approach is fine but the interface implementation makes it a bit more obvious and easier to search on.</p>

<h3 id="applicationlistener-interface">ApplicationListener Interface</h3>
<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">@Service</span>
<span class="kd">class</span> <span class="nc">EmailService</span> <span class="p">:</span> <span class="n">ApplicationListener</span><span class="p">&lt;</span><span class="n">UserSignedUpEvent</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onApplicationEvent</span><span class="p">(</span><span class="n">event</span><span class="p">:</span> <span class="n">UserSignedUpEvent</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="py">user</span> <span class="p">=</span> <span class="n">userSignedUpEvent</span><span class="p">.</span><span class="n">source</span> <span class="k">as</span> <span class="n">User</span>
        <span class="c1">// send out the email
</span>    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h3 id="eventlistener-annotation">@EventListener Annotation</h3>
<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">@Service</span>
<span class="kd">class</span> <span class="nc">EmailService</span> <span class="p">{</span>

    <span class="n">@EventListener</span>
    <span class="k">fun</span> <span class="nf">sendWelcomeEmail</span><span class="p">(</span><span class="n">userSignedUpEvent</span><span class="p">:</span> <span class="n">UserSignedUpEvent</span><span class="p">){</span>
        <span class="kd">var</span> <span class="py">user</span> <span class="p">=</span> <span class="n">userSignedUpEvent</span><span class="p">.</span><span class="n">source</span> <span class="k">as</span> <span class="n">User</span>
        <span class="c1">// send out the email
</span>    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div>

<h2 id="debugging-events">Debugging Events</h2>
<p>One option to debug events is have Spring print out useful information for you. There two interesting properties that you can set to print out all the registered EventListeners once at the start of the application, and other to have Spring print everytime it is publishing an event.</p>

<p>Put these in your <strong>application.properties</strong> file.</p>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Trace the publishing of events (i.e., Publishing event in ...)
</span><span class="py">logging.level.org.springframework.context.annotation</span><span class="p">=</span><span class="s">TRACE</span>

<span class="c"># Print out all the EventListeners at the start of the application.
</span><span class="py">logging.level.org.springframework.context.event.EventListenerMethodProcessor</span><span class="p">=</span><span class="s">TRACE</span>
</code></pre></div></div>

<h2 id="async-events">Async Events</h2>
<p><strong>Spring Events are synchronous by default!</strong> This something comes as a shock to people but you must realize that making something automatically async is actually quite dangerous.</p>

<p>You can easily make an EventListener asynchronous by using the <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/scheduling/annotation/Async.html">@Async</a> annotation. Be warned though that there is more to this little annotation and you should understand how it works before using it.</p>

<ul>
  <li><strong>Read:</strong> <a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#context-functionality-events-async"><strong>spring.io:</strong> Asynchronous Listeners</a></li>
  <li><strong>Read:</strong> <a href="http://www.baeldung.com/spring-async"><strong>baeldung.com:</strong> Spring Async</a></li>
</ul>

<h2 id="transactional-events">Transactional Events</h2>
<p>Transactions are discussed in another section but it’s important to understand that they play a role with EventListeners. You have the abilitiy to advise Spring on when and how to run your listeners with respect to transaction that may be going on. To do this you essentially swap out @EventListener with <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/transaction/event/TransactionalEventListener.html">@TransactionalEventListener</a>.</p>

<p>An example of this is would be a MailService listener that should send a welcome E-Mail out only after a user has successfully been commited to the database.</p>

<ul>
  <li><strong>Read:</strong> <a href="https://dzone.com/articles/transaction-synchronization-and-spring-application"><strong>dzone.com:</strong> Understanding @TransactionalEventListener</a></li>
  <li><strong>Read:</strong> <a href="https://spring.io/blog/2015/02/11/better-application-events-in-spring-framework-4-2"><strong>spring.io:</strong> Better application events in Spring Framework 4.2</a></li>
</ul>

<h2 id="ordering-of-event-listeners">Ordering of Event Listeners</h2>
<p>Ordering things is a rather interesting concept with Spring. When you register multiple things of the same type into the (depending on what it is…) Spring will generally store them as a list <strong>in the order that there detected by Spring during component scanning.</strong> You have a number of ways to advise Spring on the Order of components but the most abstract approach is to use an <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/annotation/Order.html">@Order</a> annotation.</p>

<ul>
  <li><strong>Read:</strong> <a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#context-functionality-events-order"><strong>spring.io:</strong> Ordering listeners</a></li>
  <li><strong>Read:</strong> <a href="https://stackoverflow.com/questions/30328897/what-is-the-use-of-order-annotation-in-spring"><strong>stackoverflow.com:</strong> What is the use of @Order annotation in Spring?</a></li>
  <li><strong>Read:</strong> <a href="https://javapapers.com/spring/spring-order-annotation/"><strong>javapapers.com:</strong> Spring Order Annotation</a></li>
  <li><strong>Read:</strong> <a href="https://www.logicbig.com/tutorials/spring-framework/spring-core/using-depends-on.html"><strong>logicbig.com:</strong> Controlling Beans Loading Order</a></li>
</ul>

<h2 id="spring-data---domain-events-with-domainevents-and-abstractaggregateroot">Spring Data - Domain Events with @DomainEvents and AbstractAggregateRoot</h2>
<p><a href="http://projects.spring.io/spring-data/">Spring Data</a> is one of the foundational projects that many other Spring projects are based on. We’ll cover it deeper in another section but there is a really neat feature built-in releated to events.</p>

<p>Spring Data follows the concept of <a href="https://en.wikipedia.org/wiki/Domain-driven_design">Domain Driven Design </a> and has a concept called Domain Events. Essentially if you have a managed Entity (a special kinda of Bean related to persistence) then Spring Data will look for a field annotated with <a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/DomainEvents.html">@DomainEvents</a> and <strong>automatically publish those events for you when that Entity is acted upon</strong>. Spring Data provides a convenient super class for you to extend with this functionality called <a href="https://github.com/spring-projects/spring-data-commons/blob/master/src/main/java/org/springframework/data/domain/AbstractAggregateRoot.java">AbstractAggregateRoot</a>.</p>

<ul>
  <li><strong>Read:</strong> <a href="https://spring.io/blog/2017/01/30/what-s-new-in-spring-data-release-ingalls#domain-event-publication-from-aggregate-roots"><strong>spring.io:</strong> Domain event publication from aggregate roots</a></li>
  <li><strong>Read:</strong> <a href="http://zoltanaltfatter.com/2017/06/09/publishing-domain-events-from-aggregate-roots/"><strong>zoltanaltfatter.com:</strong> Publishing domain events from aggregate roots</a></li>
</ul>

<p>Take an example where you’ve modeled a bidding system where people can <strong>Bid</strong> on an <strong>Auction</strong>. I’m going to omit all the JPA annotations for simplicity and showcase the DomainEvents only.</p>

<blockquote>
  <p>You can see an entire application built with this on our github page called <a href="https://github.com/JahnelGroup/sample-applications/tree/master/jgBay">jgBay</a>.</p>
</blockquote>

<p>Here are two interesting events:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">BidRemovedEvent</span><span class="p">(</span><span class="n">auction</span><span class="p">:</span> <span class="n">Auction</span><span class="p">,</span> <span class="kd">var</span> <span class="py">bid</span><span class="p">:</span> <span class="n">Bid</span><span class="p">):</span> <span class="n">AuctionEvent</span><span class="p">(</span><span class="n">auction</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">BidAddedEvent</span><span class="p">(</span><span class="n">auction</span><span class="p">:</span> <span class="n">Auction</span><span class="p">,</span> <span class="kd">var</span> <span class="py">bid</span><span class="p">:</span> <span class="n">Bid</span><span class="p">):</span> <span class="n">AuctionEvent</span><span class="p">(</span><span class="n">auction</span><span class="p">)</span>
</code></pre></div></div>

<p>Notice although we’re adding and removing Bids that the event is actually raised against an Auction. This is because in our modeling the Auction is the <a href="https://martinfowler.com/bliki/DDD_Aggregate.html">Aggregate</a>.</p>

<p>Here is the <strong>Auction</strong> with the interesting piece of code related to events.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
  * Models an Auction and inherits from AbstractAggregateRoot to leverage DomainEvents.
  */</span>
<span class="n">@Entity</span>
<span class="kd">data class</span> <span class="nc">Auction</span> <span class="p">:</span> <span class="n">AbstractAggregateRoot</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="py">bids</span><span class="p">:</span> <span class="n">MutableSet</span><span class="p">&lt;</span><span class="n">Bid</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">mutableSetOf</span><span class="p">()</span>
    
    <span class="cm">/**
     * Add a new bid to this Auction
     */</span>
    <span class="k">fun</span> <span class="nf">addBid</span><span class="p">(</span><span class="n">bid</span><span class="p">:</span> <span class="n">Bid</span><span class="p">):</span> <span class="n">Auction</span> <span class="p">{</span>
        <span class="n">bid</span><span class="p">.</span><span class="n">auction</span> <span class="p">=</span> <span class="k">this</span>
        <span class="n">bids</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">bid</span><span class="p">)</span>
        
        <span class="c1">// this comes from AbstractAggregateRoot
</span>        <span class="c1">// when called it will put BidAddedEvent into the DomainEvents list and 
</span>        <span class="c1">// Spring Data will raise them automatically when this Entity hits the persistence layer.        
</span>        <span class="n">registerEvent</span><span class="p">(</span><span class="n">BidAddedEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">bid</span><span class="p">))</span>
        
        <span class="k">return</span> <span class="k">this</span>
    <span class="p">}</span>

    <span class="cm">/**
     * Remove a bid from this Auction
     */</span>
    <span class="k">fun</span> <span class="nf">removeBid</span><span class="p">(</span><span class="n">bid</span><span class="p">:</span> <span class="n">Bid</span><span class="p">):</span> <span class="n">Auction</span> <span class="p">{</span>
        <span class="n">bids</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">bid</span><span class="p">)</span>
        <span class="n">bid</span><span class="p">.</span><span class="n">auction</span> <span class="p">=</span> <span class="k">null</span>
        <span class="n">registerEvent</span><span class="p">(</span><span class="n">BidRemovedEvent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">bid</span><span class="p">))</span> <span class="c1">// this comes from AbstractAggregateRoot
</span>        <span class="k">return</span> <span class="k">this</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Here is an example use of these methods with a Controller.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">@RestController</span>
<span class="n">@RequestMapping</span><span class="p">(</span><span class="s">"/api/auctions/{id}"</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">BidController</span><span class="p">(</span><span class="kd">val</span> <span class="py">auctionRepo</span><span class="p">:</span> <span class="n">AuctionRepo</span><span class="p">){</span>

    <span class="n">@PostMapping</span><span class="p">(</span><span class="s">"/submitBid"</span><span class="p">)</span>
    <span class="k">fun</span> <span class="nf">submitBid</span><span class="p">(</span><span class="n">@PathVariable</span><span class="p">(</span><span class="s">"id"</span><span class="p">)</span> <span class="n">auction</span><span class="p">:</span> <span class="n">Auction</span><span class="p">?,</span> <span class="n">@RequestBody</span> <span class="n">bid</span><span class="p">:</span> <span class="n">Bid</span><span class="p">)</span> <span class="p">:</span> <span class="n">Bid</span> <span class="p">{</span>
        <span class="c1">// omitted validation code 
</span>        
        <span class="n">auction</span><span class="p">.</span><span class="n">addBid</span><span class="p">(</span><span class="n">bid</span><span class="p">)</span> <span class="c1">// this method is show above and it will queue up the BidAddedEvent
</span>        <span class="n">auctionRepo</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">auction</span><span class="p">)</span> <span class="c1">// Spring Data will detect the BidAddedEvent and raise it here
</span>    <span class="p">}</span>

    <span class="c1">// other mappings...
</span><span class="p">}</span>
</code></pre></div></div>

<p>Now you can react to these just like any other event!</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@Service
class BidNotificationService {
    // notify previous high bidder that they were just out bid
    @EventListener fun notifyOutbidParties(bidAddedEvent: BidAddedEvent){
        // code ...
    }
}
</code></pre></div></div>

<h2 id="spring-integration---applicationeventlisteningmessageproducer">Spring Integration - ApplicationEventListeningMessageProducer</h2>
<p>We cover Spring Integration in another section but it’s important to know that it has support for listening to Spring ApplicationEvents with a component called <a href="https://docs.spring.io/spring-integration/api/org/springframework/integration/event/inbound/ApplicationEventListeningMessageProducer.html">ApplicationEventListeningMessageProducer</a>.</p>

<ul>
  <li><strong>Read:</strong> <a href="https://docs.spring.io/spring-integration/reference/html/applicationevent.html"><strong>spring.io:</strong> Spring ApplicationEvent Support</a></li>
</ul>

<p>Here is an example of defining the event producer.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">@Configuration</span>
<span class="kd">class</span> <span class="nc">EventsIntegrationConfig</span> <span class="p">{</span>

    <span class="cm">/**
     * Listen for the Bid related events and publishes them on a pub/sub channel.
     */</span>
    <span class="n">@Bean</span>
    <span class="k">fun</span> <span class="nf">bidEventsProducer</span><span class="p">():</span> <span class="n">ApplicationEventListeningMessageProducer</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">producer</span> <span class="p">=</span> <span class="n">ApplicationEventListeningMessageProducer</span><span class="p">()</span>
        <span class="n">producer</span><span class="p">.</span><span class="n">setEventTypes</span><span class="p">(</span>
            <span class="n">BidAddedEvent</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">,</span>
            <span class="n">BidUpdatedEvent</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">,</span>
            <span class="n">BidRemovedEvent</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span>
        <span class="n">producer</span><span class="p">.</span><span class="n">setOutputChannelName</span><span class="p">(</span><span class="s">"bidEventsPubSubChannel"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">producer</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div>

  </div>
</div>
    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
    
    
    
    
    
    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Steven Zgaljic. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.1.0/js/all.js"></script>








  </body>
</html>